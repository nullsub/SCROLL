aspect Evaluation {

    public Playable Tree.findPlayableByObject(Object object) {
        //System.out.println("Tree.findPlayableByObject()");

        for(Playable p : this.getNaturals()) {
            Playable ret = p.findPlayableByObject(object);
            if(ret != null) {
                return  ret;
            }
        }
        return null;
    }


    public Playable Playable.findPlayableByObject(Object object) {
       if(this.getObject() == object) {
           return this;
       }

        for(Playable p : this.getRoles()) {
            Playable ret = p.findPlayableByObject(object);
            if(ret != null) {
                return  ret;
            }
        }
        return null;
    }



    public Boolean Tree.removeNatural(Playable player) {
           int toDelete = -1;
           for(Playable p : this.getNaturals()) {
                if(p.getObject() == player.getObject()) {
                    toDelete = this.getNaturals().getIndexOfChild(p);
                    break;
                }
           }
           if(toDelete > -1) {
                this.getNaturals().removeChild(toDelete);
                return true;
           }
           return false;
    }

    public Boolean Playable.removeRole(Playable player) {
          //System.out.println("removeRole()");
          int toDelete = -1;
          for(Playable p : this.getRoles()) {
            if(p.getObject() == player.getObject()) {
                toDelete = this.getRoleList().getIndexOfChild(p);
                break;
            }
          }
          if(toDelete > -1) {
            this.getRoleList().removeChild(toDelete);
            return true;
          }

          return false;
    }

        public Playable Tree.getPredecessor(Playable player) {
            //System.out.println("getPredecessor()");

            for(Playable n : this.getNaturals()) {
                java.util.List<Playable> ret = scala.collection.JavaConversions.seqAsJavaList(n.getPlayers());
                for(Playable p: ret) {
                    for(Playable role : p.getRoles()){
                        if(role == player) {
                            return p;
                        }
                    }
                }
            }
            return null;
        }



    public  scala.collection.Seq<Playable> Playable.getPlayers() {
        //System.out.println("getPlayers()");

        java.util.List<Playable> list = new java.util.ArrayList<Playable>();
        list.add(this);
        list.addAll(scala.collection.JavaConversions.seqAsJavaList(this.successors()));

        return scala.collection.JavaConverters.asScalaIteratorConverter(list.iterator()).asScala().toSeq();
    }

    public  scala.collection.Seq<Playable> Playable.successors() {
            //System.out.println("successors()");

            java.util.List<Playable> list = new java.util.ArrayList<Playable>();

            for(Playable p : this.getRoles()){
                list.addAll(scala.collection.JavaConversions.seqAsJavaList(p.getPlayers()));
            }
            return scala.collection.JavaConverters.asScalaIteratorConverter(list.iterator()).asScala().toSeq();
    }
}
